import{r as i,u as x,b as y,a as E,e as b,f as C,j as t}from"./index-BzeirQbh.js";import{P as v}from"./PageLayout-BXdVDYeO.js";import{T as w}from"./Table-BuxUeY2K.js";import{D as N}from"./DeleteButton-CKeFKd-L.js";import{E as M}from"./EditButton-D_VtM5FD.js";import{B as D}from"./Button-DAaJg7TO.js";import{F as L}from"./PlusIcon-RDI3_RYo.js";const R=()=>{const[n,d]=i.useState(1),[m,u]=i.useState(10),l=x(),a=y(),{toast:r}=E();i.useEffect(()=>{(a.state||a.state)&&(r({title:`Package ${a.state}`,description:`A package has been ${a.state} successfully`,variant:"success"}),window.history.replaceState({},document.title))},[a.state,r]);const{data:s,isLoading:g,isError:P}=b({page:n,limit:m}),[p]=C(),h=async e=>{var o;if(window.confirm("Are you sure you want to delete this package?"))try{await p(e).unwrap(),r({title:"Package deleted",description:"The package has been successfully removed.",variant:"success"})}catch(c){r({title:"Error",description:((o=c==null?void 0:c.data)==null?void 0:o.message)||"Failed to delete package",variant:"error"})}},j=(s==null?void 0:s.items.map(e=>({id:e._id,code:e.code,prices:e.prices,projectsPerMonth:e.projectsPerMonth??"UNLIMITED",contactClicksPerProject:e.contactClicksPerProject??"UNLIMITED"})))||[],f=[{header:"Code",accessor:"code"},{header:"Prices",accessor:e=>e.prices?Object.entries(e.prices).map(([o,c])=>`${o}: ${c}`).join(", "):"-"},{header:"ProjectsPerMonth",accessor:"projectsPerMonth"},{header:"ContactClicksPerProject",accessor:"contactClicksPerProject"},{header:"Actions",accessor:e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(M,{title:`Edit ${e.name}`,onClick:()=>l(`/admin/packages/edit/${e.id}`)}),t.jsx(N,{title:`Delete ${e.name}`,onClick:()=>h(e.id)})]})}],k=[{label:"Packages",path:""}];return t.jsxs(v,{title:"Manage Packages",breadcrumbs:k,children:[t.jsx("div",{className:"flex justify-end items-start",children:t.jsx(D,{size:"sm",onClick:()=>l("/admin/packages/create"),leftIcon:t.jsx(L,{className:"w-4 h-4"}),children:"Add New"})}),g?t.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading plans..."}):P?t.jsx("div",{className:"text-center py-10 text-red-500",children:"Error loading plans. "}):t.jsx(w,{columns:f,data:j,itemsPerPage:10,sortable:!0,currentPage:n,totalEntries:s==null?void 0:s.total,onPageChange:e=>d(e),onItemsPerPageChange:e=>{u(e),d(1)}})]})};export{R as default};
